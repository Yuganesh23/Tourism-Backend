<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Reset Password</title>
<style>
body{
  font-family:'Cinzel', serif;
  background:url("images/sky.jpg") center/cover fixed;
  display:flex;justify-content:center;align-items:center;height:100vh;margin:0;
}
.box{
  width:300px;padding:25px;border-radius:18px;
  background:rgba(255,255,255,0.6);backdrop-filter:blur(8px);
  box-shadow:0 8px 20px rgba(0,0,0,0.12);text-align:center;
}
input{width:100%;padding:10px;border-radius:10px;border:1px solid #bcdcdc;margin-top:10px;}
button{margin-top:18px;width:100%;padding:12px;border:0;background:#00a6a6;color:white;border-radius:10px;font-size:17px;cursor:pointer;}
button:hover{background:#007f7f;}
</style>
</head>
<body>

<div class="box">
  <h2>Reset Password</h2>
  <input type="text" placeholder="Enter OTP"><br>
  <input type="password" placeholder="Enter New Password">
  <button>Update Password</button>
</div>
<script>
document.querySelector("button").addEventListener("click", ()=>{
  const otp = document.querySelectorAll("input")[0].value;
  const newPassword = document.querySelectorAll("input")[1].value;
  const email = localStorage.getItem("fp_email");

  // FIRST verify OTP
  fetch("http://localhost:8080/api/forgot-password/verify-otp",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({email:email, otp:otp})
  })
  .then(res=>res.text())
  .then(msg=>{
    if(msg.includes("Successfully")){
      // then reset
      fetch("http://localhost:8080/api/forgot-password/reset",{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({email:email, newPassword:newPassword})
      })
      .then(res=>res.text())
      .then(msg2=>{
        alert(msg2);
        window.location="login.html";
      })
    }else{
      alert(msg);
    }
  })
})
</script>

</body>
</html>
